<Window x:Class="TRPGGMTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:TRPGGMTool.Converters"
        Title="{Binding WindowTitle}" Height="600" Width="1000">

    <!-- XAMLで直接定義 -->
    <Window.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter"/>
    </Window.Resources>

    <Grid>
        <DockPanel>
            <!-- メニューバー（ツールバー機能統合） -->
            <Menu DockPanel.Dock="Top">
                <MenuItem Header="ファイル(_F)">
                    <MenuItem Header="新規作成(_N)" Command="{Binding NewScenarioCommand}" InputGestureText="Ctrl+N" />
                    <MenuItem Header="開く(_O)" InputGestureText="Ctrl+O" />
                    <MenuItem Header="保存(_S)" Command="{Binding SaveScenarioCommand}" InputGestureText="Ctrl+S" />
                    <MenuItem Header="名前を付けて保存(_A)" InputGestureText="Ctrl+Shift+S" />
                    <Separator />
                    <MenuItem Header="終了(_X)" InputGestureText="Alt+F4" />
                </MenuItem>
                <MenuItem Header="編集(_E)">
                    <MenuItem Header="シーン追加(_A)" />
                    <MenuItem Header="項目追加(_I)" />
                </MenuItem>
                <MenuItem Header="設定(_S)">
                    <MenuItem Header="プレイヤー設定(_P)" />
                    <MenuItem Header="判定レベル設定(_J)" />
                </MenuItem>
                <MenuItem Header="ヘルプ(_H)">
                    <MenuItem Header="開発(_D)">
                        <MenuItem Header="テストウィンドウ(_T)" Click="TestMenuItem_Click" />
                    </MenuItem>
                </MenuItem>
            </Menu>

            <!-- メインコンテンツ -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- シナリオ基本情報 -->
                <GroupBox Grid.Row="0" Header="シナリオ情報" Margin="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Label Grid.Row="0" Grid.Column="0" Content="タイトル:" />
                        <TextBox Grid.Row="0" Grid.Column="1" 
                                Text="{Binding ScenarioTitle, UpdateSourceTrigger=PropertyChanged}" 
                                Margin="5" />

                        <Label Grid.Row="1" Grid.Column="0" Content="作成者:" />
                        <TextBox Grid.Row="1" Grid.Column="1" 
                                Text="{Binding Author, UpdateSourceTrigger=PropertyChanged}" 
                                Margin="5" />

                        <Label Grid.Row="2" Grid.Column="0" Content="説明:" />
                        <TextBox Grid.Row="2" Grid.Column="1" 
                                Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}" 
                                Margin="5" TextWrapping="Wrap" Height="60" />
                    </Grid>
                </GroupBox>

                <!-- ゲーム設定 -->
                <GroupBox Grid.Row="1" Header="ゲーム設定" Margin="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- プレイヤー設定 -->
                        <GroupBox Grid.Column="0" Header="プレイヤー" Margin="5">
                            <StackPanel>
                                <TextBlock Text="{Binding PlayerCount, StringFormat='プレイヤー数: {0}人'}" Margin="5"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- 判定レベル設定 -->
                        <GroupBox Grid.Column="1" Header="判定レベル" Margin="5">
                            <StackPanel>
                                <TextBlock Text="{Binding JudgmentLevelCount, StringFormat='判定レベル数: {0}'}" Margin="5"/>
                            </StackPanel>
                        </GroupBox>
                    </Grid>
                </GroupBox>

                <!-- シーン一覧 -->
                <GroupBox Grid.Row="2" Header="シーン" Margin="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- シーン一覧 -->
                        <ListBox Grid.Column="0" Margin="5"
                                ItemsSource="{Binding Scenes}"
                                DisplayMemberPath="Name"
                                SelectedItem="{Binding SelectedScene}" />

                        <!-- シーン詳細 -->
                        <Grid Grid.Column="1" Margin="5">
                            <!-- シーン未選択時 -->
                            <TextBlock Text="シーンを選択してください" 
                                      VerticalAlignment="Center" 
                                      HorizontalAlignment="Center"
                                      Visibility="{Binding IsSceneSelected, Converter={StaticResource InverseBooleanToVisibilityConverter}}" />

                            <!-- シーン選択時 -->
                            <ScrollViewer Visibility="{Binding IsSceneSelected, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedScene.Name}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                                    <TextBlock Text="{Binding SelectedScene.Memo}" Margin="0,0,0,10"/>
                                    <TextBlock Text="{Binding SelectedScene.Items.Count, StringFormat='項目数: {0}'}" />
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Grid>
                </GroupBox>
            </Grid>
        </DockPanel>
    </Grid>
</Window>